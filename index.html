<html>
<head>
	<title>方块测试
	</title>
	<script>
	var ca;
	var arr;
	var rx,ry,rz;
	function line2d(a,b){
	ca.moveTo(Math.floor(a.x)+250,Math.floor(a.y)+250);
	ca.lineTo(Math.floor(b.x)+250,Math.floor(b.y)+250);
	ca.stroke();
	}
	function ttrans(i){
	}
	function rtrans(i){
     var	a=rx.value*Math.PI/180;
	var b=ry.value*Math.PI/180;
	var c=rz.value*Math.PI/180;
	var x=i.x*(Math.cos(b)+Math.sin(b))*(Math.cos(c)-Math.sin(c));
	var y=i.y*(Math.cos(a)-Math.sin(a))*(Math.sin(c)+Math.cos(c));
	var z=i.z*(Math.sin(a)+Math.cos(a))*(Math.cos(b)-Math.sin(b));
	var d={x:x,y:y,z:z};
	return d;
	}
	function trans(a){
		a=rtrans(a);
		var b={x:0,y:0,z:0};
		b.x=(a.x*500)/a.z;
		b.y=(a.y*500)/a.z;
		b.z=a.z;
		return b;
	}
	function shape2d(a){
		for(var i=0;i<a.length;i++){
			if(i==0){
				ca.moveTo(Math.floor(a[i].x)+250,Math.floor(a[i].y)+250);
			}else{
				ca.lineTo(Math.floor(a[i].x)+250,Math.floor(a[i].y)+250);
			}
		}
			ca.closePath();
			ca.stroke();
			
	}
	function shape3d(a){
		var b=new Array();
		for(var i=0;i<a.length;i++){
			b[i]=trans(a[i]);
		}
		shape2d(b);
	}
	function cube(a){
		var v111={
			x:a.x+0.5,
			y:a.y+0.5,
			z:a.z+0.5,
			};
		var v110={
			x:a.x+0.5,
			y:a.y+0.5,
			z:a.z-0.5,
			};
		var v101={
			x:a.x+0.5,
			y:a.y-0.5,
			z:a.z+0.5,
			};
		var v100={
			x:a.x+0.5,
			y:a.y-0.5,
			z:a.z-0.5,
			};
		var v011={
			x:a.x-0.5,
			y:a.y+0.5,
			z:a.z+0.5,
			};
		var v010={
			x:a.x-0.5,
			y:a.y+0.5,
			z:a.z-0.5,
			};
		var v001={
			x:a.x-0.5,
			y:a.y-0.5,
			z:a.z+0.5,
			};
		var v000={
			x:a.x-0.5,
			y:a.y-0.5,
			z:a.z-0.5,
			};
		var s1=new Array(v000,v100,v101,v001);
		var s2=new Array(v010,v011,v111,v110);
		var s3=new Array(v010,v110,v100,v000);
		var s4=new Array(v011,v001,v101,v111);
		var s5=new Array(v000,v001,v011,v010);
		var s6=new Array(v110,v111,v101,v100);
		shape3d(s1);
		shape3d(s2);
		shape3d(s3);
		shape3d(s4);
		shape3d(s5);
		shape3d(s6);
	}
	function cubegen(){
			arr=new Array();
	//var b;
	ca.clearRect(0,0,500,500);
	ca.width=ca.width;
	for(var i=0;i<10;i++){
		var b={x:0,y:0,z:0};
		b.x=Math.floor(Math.random()*20)-10;
		b.y=Math.floor(Math.random()*20)-10;
		b.z=Math.floor(Math.random()*20)+5;
		if(arr.indexOf(b)==-1){
			arr.push(b);
		}
	}
}
	function shade(){
		
	ca=document.getElementById("canv");
	rx=document.getElementById("rx");
	ry=document.getElementById("ry");
	rz=document.getElementById("rz");
	ca=ca.getContext("2d");

	for(var i=0;i<arr.length;i++){
		cube(arr[i]);
	}
}
function clear(){
	ca.clearRect(0,0,500,500);
}
</script>
</head>
<body>
<canvas id="canv" width="500" height="500"
style="border:1px solid #000000;">
</canvas> 
<br>
<button onclick="shade()">SHADE</button><button onclick="cubegen()">NEW CUBES</button><button onclick="clear()">CLEAR</button>
<br>
<input id="rx" type="range"  step="1" value="0" min="-180" max="180"/>
<input id="ry" type="range" step="1" value="0" min="-180" max="180"/>
<input id="rz" type="range" step="1" value="0" min="-180" max="180"/>

</body>
</html>
